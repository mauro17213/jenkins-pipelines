<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<ui:composition template="/home.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="bodyJR">
        <style>
            .ui-panelgrid .ui-grid-responsive .ui-panelgrid-cell {
                border: 1px solid #e5e2e2;
            }
            .ui-g > div {
                border: 1px solid #e5e2e2;
            }
            .ui-panelgrid .ui-panelgrid-footer {
                text-align: center;
                padding: 2px 5px;
            }
        </style>
        <center>  
            <h:form id="frmProcesos">
                <p:remoteCommand name="cerrarDialogoSelPrestador" action="#{cargaProcesosBean.cerrarDialogoCntPrestador()}"/>
                <p:toolbar>
                    <f:facet name="left" >
                        <span title="#{cargaProcesosBean.modulo.descripcion}">#{cargaProcesosBean.modulo.nombre}</span>
                    </f:facet>
                    <f:facet name="right">
                        <p:commandButton rendered="#{cargaProcesosBean.accionListar}" title="Refrescar" ajax="false" actionListener="#{cargaProcesosBean.refrescar()}" icon="ui-icon-refresh"/>
                        <p:commandButton rendered="#{cargaProcesosBean.accionCrear}" title="Crear Proceso" actionListener="#{cargaProcesosBean.crear()}"  icon="ui-icon-document" update="@form"/>
                    </f:facet>
                </p:toolbar>
                <p:dataTable id="tablaRegistros" widgetVar="tablaWidget" var="obj" value="#{cargaProcesosBean.lazyProcesos}" rowKey="#{obj.id}"
                             rows="30" paginator="true" lazy="true" reflow="true"
                             currentPageReportTemplate="Registros del {startRecord} al {endRecord} de {totalRecords}, Página {currentPage} de {totalPages}"
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="5,10,30,50,100" 
                             emptyMessage="No se encontraron registros">

                    <p:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="Acciones"/>
                        </f:facet>    
                        <p:commandButton rendered="#{cargaProcesosBean.accionVer}" title="Ver" actionListener="#{cargaProcesosBean.ver(obj)}" icon="ui-icon-search"/>
                        <p:commandButton rendered="#{cargaProcesosBean.accionEditar}" title="Editar" actionListener="#{cargaProcesosBean.editar(obj)}" icon="ui-icon-pencil"/>
                        <p:commandButton rendered="#{cargaProcesosBean.accionBorrar}" title="Borrar" actionListener="#{cargaProcesosBean.borrarr(obj.id)}" icon="ui-icon-trash">
                            <p:confirm header="Confirmación" message="Está seguro que desea eliminar?" icon="ui-icon-alert" />
                        </p:commandButton>
                        <p:commandButton rendered="#{cargaProcesosBean.accionAdicional2}" title="Prestadores" actionListener="#{cargaProcesosBean.listarPrestadores(obj.id)}" icon="ui-icon-home"/>
                        <p:commandButton rendered="#{cargaProcesosBean.accionAdicional3}" title="Periodos" actionListener="#{cargaProcesosBean.listarPeriodos(obj.id)}" icon="ui-icon-calendar"/>
                    </p:column>

                    <p:column headerText="Nombre" filterBy="#{obj.nombre}">
                        <f:facet name="filter">
                            <p:inputText label="Nombre" maxlength="64" style="width: 80%;" onchange="PF('tablaWidget').filter()"/>
                        </f:facet>
                        <h:outputText value="#{obj.nombre}"/>
                    </p:column>

                    <p:column headerText="Activo" filterBy="#{obj.activo}">
                        <f:facet name="filter">
                            <p:inputText label="Activo" maxlength="64" style="width: 80%;" onchange="PF('tablaWidget').filter()"/>
                        </f:facet>
                        <h:outputText value="#{obj.activo ? 'Sí' : 'No'}"/>
                    </p:column>

                    <p:column headerText="Descripción">
                        <h:outputText value="#{obj.descripcion}"/>
                    </p:column>

                    <p:column headerText="Usuario crea">
                        <h:outputText value="#{obj.usuarioCrea}"/>
                    </p:column>

                    <p:column headerText="Fecha hora crea" >                      
                        <h:outputText value="#{obj.fechaHoraCrea}">
                            <f:convertDateTime pattern="yyyy-MM-dd HH:mm:ss" />
                        </h:outputText>
                    </p:column>

                </p:dataTable>
                <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                    <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" style="left:25%"/>
                    <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" style="left:25%"/>
                </p:confirmDialog>


            </h:form>

            <!-- Ver -->
            <p:dialog header="Ver" widgetVar="dialogoVer" appendTo="@(body)" modal="true" width="80%">

                <h:form class="frmAuditoria" style="margin-top: -15px; text-align: right;">
                    <p:commandButton id="auditoria" class="btnAuditoria" action="#{cargaProcesosBean.getAuditoria(cargaProcesosBean.objeto.auditoriaStrHTML)}" icon="ui-icon-comment" title="Auditoría" />
                </h:form>
                <p:scrollPanel mode="native" style="height:400px">
                    <h:form id="frmVer">
                        <p:panelGrid id="panelVer">
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Nombre" style="font-weight:bold" />
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:outputLabel value="#{cargaProcesosBean.objeto.nombre}"/>
                                </p:column>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Activo" style="font-weight:bold" />
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:outputLabel value="#{cargaProcesosBean.objeto.activo ? 'Sí' : 'No'}" />
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Descripción" style="font-weight:bold"  />
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:outputLabel value="#{cargaProcesosBean.objeto.descripcion}"/>
                                </p:column>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Editable" style="font-weight:bold"  />
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:outputLabel value="#{cargaProcesosBean.objeto.editable ? 'Sí' : 'No'}" />
                                </p:column>
                            </p:row>
                        </p:panelGrid>


                        <!-- Usuarios -->
                        <p:panel id="pUsuariosVer" header="Usuarios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:dataTable id="tablaUsuarioVer" var="usuariosVer" value="#{cargaProcesosBean.objeto.carProcesoUsuariosList}" widgetVar="tablaFuncionarioVer" resizableColumns="true" emptyMessage="No se encontraron funcionarios" style="text-align: center">
                                <p:column headerText="Usuario">
                                    <h:outputText value="#{usuariosVer.usuario.nombre}" />
                                </p:column>
                                 <p:column headerText="Activo">
                                    <h:outputText value="#{usuariosVer.activo == true ? 'Sí' : 'No'}" />
                                </p:column>
                                <p:column headerText="Tipo">
                                    <h:outputText value="#{usuariosVer.admin == true ? 'Administrador' : 'Operativo'}" />
                                </p:column>
                            </p:dataTable>   
                        </p:panel>

                        <p:panel id="pPanelJson" header="Panel JSON" style="width: 100%; margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid>
                                <p:row>
                                    <p:column class="ui-g-2">
                                        <p:outputLabel value="Estructura JSON"  class="header-back" />
                                    </p:column>               
                                    <p:column class="ui-g-10">
                                        <p:inputTextarea value="#{cargaProcesosBean.objeto.estructuraJson}" autoResize="false" rows="30" cols="55" style="width: 100%; height: 80%" disabled="true"/>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                        </p:panel>

                        <p:panelGrid  style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoVer').hide()" immediate="true"/>
                                    </p:column>
                                </p:row>
                            </f:facet>                        
                        </p:panelGrid>

                    </h:form>
                </p:scrollPanel>
            </p:dialog>

            <!-- crear -->
            <p:dialog header="Crear" widgetVar="dialogoCrear" appendTo="@(body)" modal="true" width="90%">
                <p:scrollPanel mode="native" style="height:400px">
                    <h:form id="frmCrear">
                        <p:panelGrid id="panelCrear">
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Nombre" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:inputText value="#{cargaProcesosBean.objeto.nombre}" style="width: 95%;" required="true"/>
                                </p:column>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Activo" for="activo" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneRadio id="activo" value="#{cargaProcesosBean.objeto.activo}" required="true">
                                        <f:selectItem itemLabel="Si" itemValue="true" />
                                        <f:selectItem itemLabel="No" itemValue="false" />
                                    </p:selectOneRadio>
                                </p:column>
                            </p:row>

                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Descripción"  class="header-back" style="font-weight:bold"/>
                                </p:column>               
                                <p:column class="ui-g-4">
                                    <p:inputText value="#{cargaProcesosBean.objeto.descripcion}"  style="width: 95%;" required="true"/>
                                </p:column>

                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Editable" for="editable" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneRadio id="editable" value="#{cargaProcesosBean.objeto.editable}" required="true">
                                        <f:selectItem itemLabel="Si" itemValue="true" />
                                        <f:selectItem itemLabel="No" itemValue="false" />
                                    </p:selectOneRadio>
                                </p:column>
                            </p:row>           
                        </p:panelGrid>

                        <!-- Usuario -->
                        <p:panel id="pUsuarios" header="Usuarios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <div align="right"> 
                                <p:commandButton immediate="true" action="#{cargaProcesosBean.crearUsuario()}" icon="ui-icon-person" title="Agregar Funcionario"/>
                            </div>
                            <p:dataTable id="tablaUsuarioCrear" var="usuarioVar" value="#{cargaProcesosBean.objeto.carProcesoUsuariosList}" widgetVar="tablaUsuarioCrear" resizableColumns="true" emptyMessage="No se encontraron usuarios" style="text-align: center">
                                <p:column headerText="Acciones" style="text-align: center">
                                    <p:commandButton title="Editar" immediate="true" action="#{cargaProcesosBean.editarUsuario(usuarioVar)}" icon="ui-icon-pencil"/>
                                    <p:commandButton title="Borrar" immediate="true" action="#{cargaProcesosBean.borrarUsuario(usuarioVar)}" icon="ui-icon-trash">
                                        <p:confirm header="Confirmación" message="¿Está seguro que desea eliminar a #{usuarioVar.usuario.nombre}?" icon="ui-icon-alert" />
                                    </p:commandButton>
                                </p:column>
                                <p:column headerText="Usuario">
                                    <h:outputText value="#{usuarioVar.usuario.nombre}" />
                                </p:column>
                                 <p:column headerText="Activo">
                                    <h:outputText value="#{usuarioVar.activoStr}" />
                                </p:column>
                                <p:column headerText="Tipo">
                                    <h:outputText value="#{usuarioVar.adminStr}" />
                                </p:column>

                            </p:dataTable>   
                        </p:panel>

                        <p:panelGrid >
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Estructura JSON"  class="header-back" style="font-weight:bold"/>
                                </p:column>               
                                <p:column class="ui-g-10">
                                    <p:inputTextarea value="#{cargaProcesosBean.objeto.estructuraJson}" autoResize="false" rows="30" cols="55" style="width: 100%; height: 80%" required="true"/>
                                </p:column>
                            </p:row>     
                        </p:panelGrid>

                        <p:panelGrid  style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Guardar" type="button" onclick="guardarRemote()" validateClient="true"/>
                                        <p:remoteCommand name="guardarRemote" action ="#{cargaProcesosBean.guardar}" update="panelCrear"/>
                                        <p:commandButton value="Cancelar" type="button" onclick="PF('dialogoCrear').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>

            <!-- Editar -->
            <p:dialog header="Editar" widgetVar="dialogoEditar" appendTo="@(body)" modal="true" width="90%">
                <h:form class="frmAuditoria" style="margin-top: -15px; text-align: right;">
                    <p:commandButton id="auditoria" class="btnAuditoria" action="#{cargaProcesosBean.getAuditoria(cargaProcesosBean.objeto.auditoriaStrHTML)}" icon="ui-icon-comment" title="Auditoría" />
                </h:form>
                <p:scrollPanel mode="native" style="height:400px">
                    <h:form id="frmEditar">
                        <p:panelGrid id="panelEditar">
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Nombre" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:inputText value="#{cargaProcesosBean.objeto.nombre}" style="width: 95%;" required="true"/>
                                </p:column>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Activo" for="activo" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneRadio id="activo" value="#{cargaProcesosBean.objeto.activo}">
                                        <f:selectItem itemLabel="Si" itemValue="true" />
                                        <f:selectItem itemLabel="No" itemValue="false" />
                                    </p:selectOneRadio>
                                </p:column>

                            </p:row>
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Descripción"  class="header-back" style="font-weight:bold"/>
                                </p:column>               
                                <p:column class="ui-g-4">
                                    <p:inputText value="#{cargaProcesosBean.objeto.descripcion}" style="width: 95%;" required="true"/>
                                </p:column>

                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Editable" for="editable" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneRadio id="editable" value="#{cargaProcesosBean.objeto.editable}">
                                        <f:selectItem itemLabel="Si" itemValue="true" />
                                        <f:selectItem itemLabel="No" itemValue="false" />
                                    </p:selectOneRadio>
                                </p:column>
                            </p:row>
                        </p:panelGrid>

                        <!-- Usuario -->
                        <p:panel id="pUsuarios" header="Usuarios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <div align="right"> 
                                <p:commandButton immediate="true" action="#{cargaProcesosBean.crearUsuario()}" icon="ui-icon-person" title="Agregar Funcionario"/>
                            </div>
                            <p:dataTable id="tablaUsuarioCrear" var="usuarioVar" value="#{cargaProcesosBean.objeto.carProcesoUsuariosList}" widgetVar="tablaUsuarioCrear" resizableColumns="true" emptyMessage="No se encontraron usuarios" style="text-align: center">
                                <p:column headerText="Acciones" style="text-align: center">
                                    <p:commandButton title="Editar" immediate="true" action="#{cargaProcesosBean.editarUsuario(usuarioVar)}" icon="ui-icon-pencil"/>
                                    <!-- Botón de borrar, cambia el ícono según si el usuario es nuevo o de la base de datos -->
                                    <p:commandButton title="Borrar" 
                                                     immediate="true" 
                                                     action="#{cargaProcesosBean.borrarUsuario(usuarioVar)}"
                                                     icon="#{empty usuarioVar.id or usuarioVar.id == 0 ? 'ui-icon-close' : 'ui-icon-trash'}">
                                        <p:confirm header="Confirmación" message="¿Está seguro que desea eliminar a #{usuarioVar.usuario.nombre}?" icon="ui-icon-alert" />
                                    </p:commandButton>

                                </p:column>
                                <p:column headerText="Usuario">
                                    <h:outputText value="#{usuarioVar.usuario.nombre}" />
                                </p:column>
                                <p:column headerText="Activo">
                                    <h:outputText value="#{usuarioVar.activoStr}" />
                                </p:column>
                                <p:column headerText="Tipo">
                                   <h:outputText value="#{usuarioVar.adminStr}" />
                                </p:column>
                            </p:dataTable>   
                        </p:panel>

                        <p:panelGrid>
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Estructura JSON"  class="header-back" style="font-weight:bold"/>
                                </p:column>               
                                <p:column class="ui-g-10">
                                    <p:inputTextarea value="#{cargaProcesosBean.objeto.estructuraJson}" autoResize="false" rows="30" cols="55" style="width: 100%; height: 80%" required="true"/>
                                </p:column>
                            </p:row>
                        </p:panelGrid>


                        <p:panelGrid  style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Modificar" type="button" onclick="modificarRemote()" validateClient="true"/>
                                        <p:remoteCommand name="modificarRemote" action="#{cargaProcesosBean.modificar}" update="panelEditar" />
                                        <p:commandButton value="Cancelar" type="button" onclick="PF('dialogoEditar').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>


            <!-- Ver Prestadores -->
            <p:dialog header="Prestador" widgetVar="dialogoVerPrestadores" appendTo="@(body)" modal="true" width="80%">
                <h:form class="frmAuditoria" style="margin-top: -15px; text-align: right;">
                    <p:commandButton title="Crear Prestador" actionListener="#{cargaProcesosBean.crearPrestador()}"  icon="ui-icon-document"/>
                </h:form>
                <h:form id="frmVerPrestador">
                    <p:dataTable id="tablaPrestadores" var="var" value="#{cargaProcesosBean.lazyPrestadores}" widgetVar="tablaPrestadores" 
                                 scrollable="true" emptyMessage="No se encontraron registros" rows="10" paginator="true" reflow="true" lazy="true"
                                 currentPageReportTemplate="Registros del {startRecord} al {endRecord} de {totalRecords}, Página {currentPage} de {totalPages}"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="5,10,30,50,100">
                        <p:column headerText="Código MinSalud">
                            <h:outputText value="#{var.prestador.codigoMinSalud}"/>
                        </p:column>
                        <p:column headerText="Clase Prestador">
                            <h:outputText value="#{var.prestador.maeClasePrestadorValor}"/>
                        </p:column>
                        <p:column headerText="Tipo Documento">
                            <h:outputText value="#{var.prestador.maeTipoDocumentoValor}"/>
                        </p:column>
                        <p:column headerText="Documento">
                            <h:outputText value="#{var.prestador.numeroDocumento}"/>
                        </p:column>

                        <p:column headerText="Razón Social">
                            <h:outputText value="#{var.prestador.razonSocial}"/>
                        </p:column>
                        <p:column headerText="Categoría">
                            <h:outputText value="#{var.prestador.categoriaPrestador}"/>
                        </p:column>
                        <p:column headerText="Nivel de Atención">
                            <h:outputText value="#{var.prestador.nivelAtencion}"/>
                        </p:column>
                        <p:column headerText="Activo">
                            <h:outputText value="#{var.activo ? 'Sí' : 'No'}" />
                        </p:column>
                        <p:column headerText="Acciones" style="text-align: center">
                            <p:commandButton title="Retirar Prestador" 
                                             action="#{cargaProcesosBean.borrarPrestador(var)}" 
                                             icon="ui-icon-trash" update=":frmVerPrestador:tablaPrestadores">
                                <p:confirm header="Confirmación" message="¿Está seguro que desea eliminar?" icon="ui-icon-alert" />
                            </p:commandButton>
                            <p:commandButton title="Editar Prestador"
                                             rendered="#{cargaProcesosBean.accionAdicional2}"
                                             action="#{cargaProcesosBean.editarPrestador(var)}" 
                                             icon="ui-icon-pencil">
                            </p:commandButton>
                        </p:column>
                    </p:dataTable>

                    <p:panelGrid id="panelAccionesCrearPrestador" style="width:100%;margin:10px 0px">
                        <f:facet name="footer">
                            <p:row>
                                <p:column colspan="4" style="text-align: center">                                    
                                    <p:commandButton value="Salir" type="button" onclick="PF('dialogoVerPrestadores').hide()" immediate="true" style="margin-left: 5px;"/>
                                </p:column>
                            </p:row>
                        </f:facet>
                    </p:panelGrid>
                </h:form>
            </p:dialog>


            <!-- Ver Periodo --> 
            <p:dialog header="Periodo" widgetVar="dialogoVerPeriodos" appendTo="@(body)" modal="true" width="80%">
                <h:form class="frmAuditoria" style="margin-top: -15px; text-align: right;">
                    <p:commandButton title="Crear Periodo" actionListener="#{cargaProcesosBean.crearPeriodo()}"  icon="ui-icon-document" />
                </h:form>
                <h:form id="frmVerPeriodo">

                    <p:dataTable id="tablaPeriodos" var="periodo" value="#{cargaProcesosBean.lazyPeriodos}" widgetVar="tablaPeriodos" 
                                 scrollable="true" emptyMessage="No se encontraron registros" rows="10" paginator="true" reflow="true" lazy="true"
                                 currentPageReportTemplate="Registros del {startRecord} al {endRecord} de {totalRecords}, Página {currentPage} de {totalPages}"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 rowsPerPageTemplate="5,10,30,50,100">
                        <p:column headerText="Acciones" style="text-align: center">
                            <p:commandButton title="Editar Periodo"
                                             rendered="#{cargaProcesosBean.accionAdicional3 and cargaProcesosBean.idRolUsuario==1}"
                                             action="#{cargaProcesosBean.editarPeriodo(periodo)}" 
                                             icon="ui-icon-pencil">
                            </p:commandButton>
                            <p:commandButton title="Borrar" immediate="true" action="#{cargaProcesosBean.borrarPeriodos(periodo)}" icon="ui-icon-trash">
                                <p:confirm header="Confirmación" message="¿Está seguro que desea eliminar a #{periodo.fechaInicio} - #{periodo.fechaFin}?" icon="ui-icon-alert" />
                            </p:commandButton>
                        </p:column>
                        <p:column headerText="Nombre periodo">
                            <h:outputText value="#{periodo.nombre}"/>
                        </p:column>
                        <p:column headerText="Inicio periodo">
                            <h:outputText value="#{periodo.fechaInicio}">
                                <f:convertDateTime pattern="yyyy-MM-dd" />
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Fin periodo">
                            <h:outputText value="#{periodo.fechaFin}">
                                <f:convertDateTime pattern="yyyy-MM-dd" />
                            </h:outputText>
                        </p:column>

                    </p:dataTable>

                    <p:panelGrid id="panelAccionesCrearPeriodo" style="width:100%;margin:10px 0px">
                        <f:facet name="footer">
                            <p:row>
                                <p:column colspan="4" style="text-align: center">
                                    <p:commandButton value="Salir" type="button" onclick="PF('dialogoVerPeriodos').hide()" immediate="true" style="margin-left: 5px;"/>
                                </p:column>
                            </p:row>
                        </f:facet>
                    </p:panelGrid>
                </h:form>
            </p:dialog>

            <!-- Crear Periodo --> 
            <p:dialog header="Crear Periodo" widgetVar="dialogoCrearPeriodos" appendTo="@(body)" modal="true" width="60%">
                <h:form id="frmCrearPeriodo">                    
                    <p:panel id="pProcesoPeriodo" header="Información del Periodo" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                        <p:panelGrid id="panelProcesoPeriodo" columns="2" layout="grid" styleClass="showcase-text-align-center">

                            <p:outputLabel value="Nombre" style="font-weight:bold" />
                            <p:inputText id="nombre" value="#{cargaProcesosBean.objetoPeriodo.nombre}" 
                                         maxlength="512" required="true" style="width:99%;" requiredMessage="Nombre: Este campo es obligatorio.">
                            </p:inputText>

                            <p:outputLabel value="Fecha Inicial" for="fechaInicio" style="font-weight:bold"/>
                            <p:calendar id="fechaInicio" label="Fecha Inicial" navigator="true" pattern="yyyy-MM-dd" 
                                        value="#{cargaProcesosBean.objetoPeriodo.fechaInicio}" 
                                        yearRange="c-100:c+10"  maxlength="10" required="true" requiredMessage="Fecha Inicial: Este campo es obligatorio." >

                            </p:calendar>

                            <p:outputLabel value="Fecha Final" for="fechaFin" style="font-weight:bold"/>
                            <p:calendar id="fechaFin" label="Fecha Final" navigator="true" pattern="yyyy-MM-dd"
                                        value="#{cargaProcesosBean.objetoPeriodo.fechaFin}" 
                                        yearRange="c-100:c+10"   maxlength="10" required="true" requiredMessage="Fecha Final: Este campo es obligatorio." >

                            </p:calendar>

                        </p:panelGrid>
                    </p:panel>

                    <p:panelGrid id="panelAccionesCrearPeriodo" style="width:100%;margin:10px 0px">
                        <f:facet name="footer">
                            <p:row>
                                <p:column colspan="4" style="text-align: center">
                                    <p:commandButton value="Guardar" type="button" onclick="guardarPeriodosRemote()" validateClient="true"/>
                                    <p:remoteCommand name="guardarPeriodosRemote" action ="#{cargaProcesosBean.guardarPeriodos()}"/>
                                    <p:commandButton value="Cancelar" type="button" onclick="PF('dialogoCrearPeriodos').hide()" immediate="true" style="margin-left: 5px;"/>
                                </p:column>
                            </p:row>
                        </f:facet>
                    </p:panelGrid>
                </h:form>
            </p:dialog>


            <!-- Crear Prestadores -->
            <p:dialog header="Crear Prestador" widgetVar="dialogoCrearPrestador" appendTo="@(body)" modal="true" width="60%">
                <h:form id="frmCrearPrestador">

                    <p:panel id="pProcesoEditarPrestador" header="Prestador" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                        <p:panelGrid id="panelPrestador" columns="2" layout="grid" styleClass="showcase-text-align-center">
                            <p:row>
                                <p:column styleClass="ui-widget-header ui-g-3" >
                                    <p:outputLabel value="Razón Social" style="font-weight:bold"/>
                                </p:column>
                                <p:column styleClass="ui-g-9">
                                    <h:outputText id="razonSocial" value="#{cargaProcesosBean.objetoPrestador.prestador.razonSocial}" />
                                    <p:commandButton id="botonConsultarPrestador" immediate="true" action="#{cargaProcesosBean.consultarCntPrestador()}" 
                                                     style="float:right" icon="ui-icon-home" title="Agregar Prestador" />
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column styleClass="ui-widget-header ui-g-3" >
                                    <p:outputLabel value="Activo" for="activo" class="header-back" style="font-weight:bold"/>
                                </p:column>
                                <p:column styleClass="ui-g-9">
                                    <p:selectBooleanButton id="activo" value="#{cargaProcesosBean.objetoPrestador.activo}" onLabel="Si" offLabel="No" onIcon="ui-icon-check" offIcon="ui-icon-close"  style="width:60px" />
                                </p:column>
                            </p:row>

                        </p:panelGrid>
                    </p:panel>
                    <!--Acciones-->

                    <p:panelGrid id="panelAccionesCrearPrestador" style="width:100%;margin:10px 0px">
                        <f:facet name="footer">
                            <p:row>
                                <p:column colspan="4" style="text-align: center">
                                    <p:commandButton value="Guardar" type="button" onclick="guardarPrestadoresRemote()" validateClient="true"/>
                                    <p:remoteCommand name="guardarPrestadoresRemote" action ="#{cargaProcesosBean.guardarPrestador}" update="frmVerPrestador"/>
                                    <p:commandButton value="Cancelar" type="button" onclick="PF('dialogoCrearPrestador').hide()" immediate="true" style="margin-left: 5px;"/>
                                </p:column>
                            </p:row>
                        </f:facet>
                    </p:panelGrid>
                </h:form>
            </p:dialog>

            <!-- Crear usuario -->
            <p:dialog header="Usuario" widgetVar="dialogoCrearUsuario" appendTo="@(body)" modal="true"  width="60%" dynamic="true">
                <p:scrollPanel mode="native">
                    <h:form id="frmCrearUsuario">
                        <p:panel id="pProcesoUsuario" header="Información de Usuario" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelProcesoUsuario" columns="2" layout="grid" styleClass="showcase-text-align-center">

                                <h:outputText value="Usuario"   class="header-back" style="font-weight:bold"/>
                                <p:selectOneMenu id="usuario" label="Usuario" value="#{cargaProcesosBean.objetoUsuarioProceso.usuario.id}" filter="true" required="true" requiredMessage="El usuario: Este campo es obligatorio" >
                                    <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />    
                                    <f:selectItems value="#{cargaProcesosBean.listaUsuarios}" var="use" itemValue="#{use.id}" itemLabel="#{use.nombre}" itemDescription="#{use.usuario}" />
                                </p:selectOneMenu>

                                <h:outputText value="Activo"  class="header-back" style="font-weight:bold"/>
                                <p:inputSwitch id="activo" value="#{cargaProcesosBean.objetoUsuarioProceso.activo}" onLabel="Sí" offLabel="No" />

                                <h:outputText value="Administrador"  class="header-back" style="font-weight:bold"/>
                                <p:inputSwitch id="admin" value="#{cargaProcesosBean.objetoUsuarioProceso.admin}" onLabel="Sí" offLabel="No" />

                            </p:panelGrid>
                        </p:panel>
                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesCrearUsuario" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton rendered="#{cargaProcesosBean.objetoUsuarioProceso.usuario.id == null}" value="Guardar" type="button" onclick="guardarUsuarioRemote()" validateClient="true"/>
                                        <p:remoteCommand name="guardarUsuarioRemote" action ="#{cargaProcesosBean.guardarUsuario}" update="frmCrearUsuario"/>
                                        <p:commandButton rendered="#{cargaProcesosBean.objetoUsuarioProceso.usuario.id != null}" value="Modificar" type="button" onclick="modificarUsuarioRemote()" validateClient="true"/>
                                        <p:remoteCommand name="modificarUsuarioRemote" action ="#{cargaProcesosBean.modificarUsuario}" update="frmCrearUsuario"/>
                                        <p:commandButton value="Cancelar" type="button" onclick="PF('dialogoCrearUsuario').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>
           

            <!-- Editar Prestador -->
            <p:dialog header="Editar Prestador" widgetVar="dialogoEditarPrestador" appendTo="@(body)" modal="true"  width="60%" dynamic="true">
                <p:scrollPanel mode="native">
                    <h:form id="frmEditarPrestador">
                        <p:panel id="pProcesoEditarPrestador" header="Editar Información Prestador" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelPrestador" columns="2" layout="grid" styleClass="showcase-text-align-center">

                                <p:outputLabel value="Razón Social" for="razonSocial" style="font-weight:bold"/>
                                <h:outputText id="razonSocial" value="#{cargaProcesosBean.objetoPrestador.prestador.razonSocial}"/>

                                <p:outputLabel value="Activo" for="activo" class="header-back" style="font-weight:bold"/>
                                <p:selectBooleanButton id="activo" value="#{cargaProcesosBean.objetoPrestador.activo}" onLabel="Si" offLabel="No" onIcon="ui-icon-check" offIcon="ui-icon-close"  style="width:60px" />

                            </p:panelGrid>
                        </p:panel>
                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesEditarPrestador" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Modificar" type="button" onclick="editarPrestadorRemote()" validateClient="true"/>
                                        <p:remoteCommand name="editarPrestadorRemote" action ="#{cargaProcesosBean.modificarPrestador()}" update="frmVerPrestador"/>                                        
                                        <p:commandButton value="Cancelar" type="button" onclick="PF('dialogoEditarPrestador').hide()" immediate="true" style="margin-left: 5px;"/>

                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>

            <!-- Editar Periodo -->
            <p:dialog header="Editar Periodo" widgetVar="dialogoEditarPeriodo" appendTo="@(body)" modal="true"  width="60%" dynamic="true">
                <p:scrollPanel mode="native">
                    <h:form id="frmEditarPeriodo">
                        <p:panel id="pProcesoPeriodo" header="Editar Periodo" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelProcesoPeriodo" columns="2" layout="grid" styleClass="showcase-text-align-center">

                                <p:outputLabel value="Nombre" style="font-weight:bold" />
                                <p:inputText id="nombre" value="#{cargaProcesosBean.objetoPeriodo.nombre}" 
                                             maxlength="512" required="true" style="width:99%;" requiredMessage="Nombre: Este campo es obligatorio.">
                                </p:inputText>

                                <p:outputLabel value="Fecha Inicial" for="fechaInicio" style="font-weight:bold"/>
                                <p:calendar id="fechaInicio" label="Fecha Inicial" navigator="true" pattern="yyyy-MM-dd" 
                                            value="#{cargaProcesosBean.objetoPeriodo.fechaInicio}" 
                                            yearRange="c-100:c+10"  maxlength="10" required="true" requiredMessage="Fecha Inicial: Este campo es obligatorio." >

                                </p:calendar>

                                <p:outputLabel value="Fecha Final" for="fechaFin" style="font-weight:bold"/>
                                <p:calendar id="fechaFin" label="Fecha Final" navigator="true" pattern="yyyy-MM-dd"
                                            value="#{cargaProcesosBean.objetoPeriodo.fechaFin}" 
                                            yearRange="c-100:c+10"   maxlength="10" required="true" requiredMessage="Fecha Final: Este campo es obligatorio." >

                                </p:calendar>

                            </p:panelGrid>
                        </p:panel>
                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesEditarPeriodo" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Modificar" type="button" onclick="modificarPeriodoRemote()" validateClient="true"/>
                                        <p:remoteCommand name="modificarPeriodoRemote" action ="#{cargaProcesosBean.modificarPeriodo}" /> 
                                        <p:commandButton value="Cancelar" type="button" onclick="PF('dialogoEditarPeriodo').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>
            <ui:include src="../contratacion/seleccion/sel_prestador.xhtml" />
        </center>
    </ui:define>
</ui:composition>
