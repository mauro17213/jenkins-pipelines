<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<ui:composition template="/home.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="bodyJR">

        <style>
            .ui-panelgrid .ui-grid-responsive .ui-panelgrid-cell {
                border: 1px solid #e5e2e2;
            }
            .ui-g > div {
                border: 1px solid #e5e2e2;
            }
            .ui-panelgrid .ui-panelgrid-footer {
                text-align: center;
                padding: 2px 5px;
            }
        </style>
        <center>
            <script>

                var currentMarker = null;
                function handlePointClick(event) {
                    currentMarker = new google.maps.Marker({
                        position: new google.maps.LatLng(event.latLng.lat(), event.latLng.lng())
                    });
                    PF('mapaWidget').addOverlay(currentMarker);
                }

                function validacion() {
                    windows.alert("01");
                }


            </script>

            <p:dialog header="Filtro" widgetVar="dialogoFiltro" appendTo="@(body)" modal="true" width="60%" style="max-height: 50%;"> 
                <p:scrollPanel mode="native" style="height: 200px;">
                    <h:form id="frmFiltro">
                        <p:panelGrid id="panelFiltro">
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Ubicación" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneMenu filter="true" id="filtroUbicacion" value="#{mapaAfiliadoBean.paramConsulta.parametroConsulta1}" style="width: 400px;" >
                                        <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />
                                        <f:selectItems value="#{mapaAfiliadoBean.listaFiltroUbicaciones}" var="ubica" itemValue="#{ubica.id}" itemLabel="#{ubica.nombre} - #{ubica.ubicacionPadre.nombre}" itemDescription="#{ubica.descripcion}" />
                                    </p:selectOneMenu>
                                </p:column>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Prestador Sede" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneMenu filter="true" id="filtroPrestadorSede" value="#{mapaAfiliadoBean.paramConsulta.parametroConsulta2}" style="width: 400px;" >
                                        <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />
                                        <f:selectItems value="#{mapaAfiliadoBean.listaFiltroPrestadorSedes}" var="sede" itemValue="#{sede.id}" itemLabel="#{sede.nombreSede}" itemDescription="#{sede.nombreSede}" />
                                    </p:selectOneMenu>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Regimen" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneMenu id="filtroRegimen" value="#{mapaAfiliadoBean.paramConsulta.parametroConsulta3}" >
                                        <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />
                                        <f:selectItems value="#{mapaAfiliadoBean.listaFiltroMaestrosRegimen}" var="reg" itemValue="#{reg.id}" itemLabel="#{reg.nombre}" itemDescription="#{reg.descripcion}" />
                                    </p:selectOneMenu>
                                </p:column>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Género" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneMenu id="filtroGenero" value="#{mapaAfiliadoBean.paramConsulta.parametroConsulta4}" >
                                        <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />
                                        <f:selectItems value="#{mapaAfiliadoBean.listaFiltroMaestrosGenero}" var="gen" itemValue="#{gen.id}" itemLabel="#{gen.nombre}" itemDescription="#{gen.descripcion}" />
                                    </p:selectOneMenu>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column class="ui-g-2">
                                    <p:outputLabel value="Modelo" style="font-weight:bold"/>
                                </p:column>
                                <p:column class="ui-g-4">
                                    <p:selectOneMenu id="filtroModeloLiquidacion" value="#{mapaAfiliadoBean.paramConsulta.parametroConsulta5}" >
                                        <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />
                                        <f:selectItems value="#{mapaAfiliadoBean.listaFiltroMaestrosModeloLiquidacion}" var="mode" itemValue="#{mode.id}" itemLabel="#{mode.nombre}" itemDescription="#{mode.descripcion}" />
                                    </p:selectOneMenu>
                                </p:column>
                                <p:column class="ui-g-2">
                                    
                                </p:column>
                                <p:column class="ui-g-4">
                                    
                                </p:column>
                            </p:row> 
                        </p:panelGrid>
                        <p:panelGrid  style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Filtrar" type="button" onclick="filtrarRemote()" validateClient="true"/>
                                        <p:remoteCommand name="filtrarRemote" action ="#{mapaAfiliadoBean.listar}"/>
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoFiltro').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>

            <h:form id="frmMapas">
                <p:growl id="mensaje" showDetail="true"/>
                <p:toolbar>
                    <f:facet name="left" >
                        <span title="#{mapaAfiliadoBean.modulo.descripcion}">#{mapaAfiliadoBean.modulo.nombre}</span>
                    </f:facet>
                    <f:facet name="right">
                        <p:commandButton rendered="#{mapaAfiliadoBean.accionListar}" title="Refrescar" ajax="false" actionListener="#{mapaAfiliadoBean.filtros}" icon="ui-icon-refresh"/>
                    </f:facet>
                </p:toolbar>
                <script src="#{mapaAfiliadoBean.rutaGoogleMapsEmpresarial}"></script>
                <div class="card">
                    <p:gmap id="mapa" center="#{mapaAfiliadoBean.centroLatitud},#{mapaAfiliadoBean.centroLongitud}" zoom="#{mapaAfiliadoBean.profundidad}" type="ROADMAP" style="width:100%;height:800px"
                            model="#{mapaAfiliadoBean.registrosMapa}" onPointClick="handlePointClick(event);" widgetVar="mapaWidget">
                        <!--<p:ajax event="stateChange" listener="#{mapaAfiliadoBean.onStateChange}" update="mapa"/>-->
                        <p:ajax event="overlaySelect" listener="#{mapaAfiliadoBean.onMarkerSelect}" update="mensaje"/>
                    </p:gmap>
                </div>
            </h:form>

            <p:dialog header="Ver" widgetVar="dialogoVer" appendTo="@(body)" modal="true" width="60%" style="max-height: 50%;"> 
                <p:scrollPanel mode="native" style="height: 200px;">
                    <h:form id="frmVer">
                        <p:panelGrid id="panelVer">
                            <p:row>
                                <p:column class="ui-g-2">

                                </p:column>
                                <p:column class="ui-g-4">

                                </p:column>
                                <p:column class="ui-g-2">

                                </p:column>
                                <p:column class="ui-g-4">

                                </p:column>
                            </p:row>                            
                        </p:panelGrid>
                        <p:panelGrid  style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoVer').hide()" immediate="true"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>-->
                </p:scrollPanel>
            </p:dialog>

        </center>
    </ui:define>
</ui:composition>
