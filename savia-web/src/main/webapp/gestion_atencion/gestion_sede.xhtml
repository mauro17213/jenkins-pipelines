<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<ui:composition template="/home.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="bodyJR">
        <h:outputScript name="js/calendar-localization.js"/>
        <h:outputStylesheet name="css/solicitudes.css"/>
        <h:outputStylesheet name="css/gp.css"/>
        <h:outputStylesheet name="css/gestionAtencion.css"/>
        <center>
            <!-- Listar -->
            <h:form id="frmSedes">
                <p:toolbar>
                    <f:facet name="left" >
                        <span title="#{gestionSedeBean.modulo.descripcion}">#{gestionSedeBean.modulo.nombre}</span>
                    </f:facet>
                    <f:facet name="right">
                        <p:commandButton rendered="#{gestionSedeBean.accionListar}" title="Refrescar" ajax="false" actionListener="#{gestionSedeBean.refrescar()}" icon="ui-icon-refresh"/>
                    </f:facet>
                </p:toolbar>
                <p:dataTable var="obj" value="#{gestionSedeBean.lazySedes}" paginator="true" rows="#{gestionSedeBean.tamanoPagina}" 
                             emptyMessage="No se encontraron registros"
                             currentPageReportTemplate="Registros del {startRecord} al {endRecord} de {totalRecords}, Página {currentPage} de {totalPages}"
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             rowsPerPageTemplate="5,10,30,50,100" id="tablaRegistros" lazy="true"
                             widgetVar="tablaWidget"
                             rowKey="#{obj.id}" reflow="true" draggableRows="false">

                    <p:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="Acciones"/>
                        </f:facet>    
                        <p:commandButton rendered="#{gestionSedeBean.accionVer}" title="Ver" actionListener="#{gestionSedeBean.ver(obj.id)}" icon="ui-icon-search"/>
                        <p:commandButton rendered="#{gestionSedeBean.accionAdicional1}" title="Configurar" actionListener="#{gestionSedeBean.verConfigurar(obj.id)}" icon="ui-icon-gear"/>
                        <p:commandButton rendered="#{gestionSedeBean.accionAdicional2}" title="Liberar" actionListener="#{gestionSedeBean.verLiberar(obj.id)}" icon="ui-icon-transfer-e-w"/>
                        <p:commandButton rendered="#{gestionSedeBean.accionAdicional3}" title="Inactivar Pantallas" actionListener="#{gestionSedeBean.inactivarPantallas(obj.id)}" icon="ui-icon-cancel"/>
                        <p:commandButton rendered="#{gestionSedeBean.accionAdicional4}" title="Reporte por sede" actionListener="#{gestionSedeBean.reportePorSede(obj.id)}" icon="ui-icon-note" />
                        <p:commandButton rendered="#{gestionSedeBean.accionAdicional5}" title="Historico" actionListener="#{gestionSedeBean.historicoSede(obj)}" icon="ui-icon-print" />
                    </p:column>

                    <p:column headerText="Nombre" filterBy="#{obj.nombre}">
                        <f:facet name="filter">
                            <p:inputText label="Nombre" maxlength="64" style="width: 80%;" onchange="PF('tablaWidget').filter()"/>
                        </f:facet>
                        <h:outputText value="#{obj.nombre}"/>
                    </p:column>

                    <p:column headerText="Empresa" filterBy="#{obj.gnEmpresaId.razonSocial}">
                        <f:facet name="filter">
                            <p:inputText label="Empresa" maxlength="64" style="width: 80%;" onchange="PF('tablaWidget').filter()"/>
                        </f:facet>
                        <h:outputText value="#{obj.gnEmpresaId.razonSocial}"/>
                    </p:column>

                    <p:column headerText="Ubicación" filterBy="#{obj.gnUbicacionId.nombre}">
                        <f:facet name="filter">
                            <p:inputText label="Ubicación" maxlength="64" style="width: 80%;" onchange="PF('tablaWidget').filter()"/>
                        </f:facet>
                        <h:outputText value="#{obj.gnUbicacionId.nombre}"/>
                    </p:column>

                    <p:column headerText="Tipo" filterBy="#{obj.maeTipoId}">
                        <f:facet name="filter">
                            <p:selectOneMenu onchange="PF('tablaWidget').filter()" style="width: 80%;">
                                <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />
                                <f:selectItems value="#{gestionSedeBean.listaTiposSede}" var="tipo" itemValue="#{tipo.id}" itemLabel="#{tipo.nombre}" />
                            </p:selectOneMenu>
                        </f:facet>
                        <h:outputText value="#{obj.maeTipoValor}"/>
                    </p:column>

                    <p:column headerText="Activo" >                      
                        <h:outputText value="#{obj.activoStr}"/>
                    </p:column>

                </p:dataTable>
                <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                    <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" style="left:25%"/>
                    <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" style="left:25%"/>
                </p:confirmDialog>
            </h:form>

            <!-- Ver -->
            <p:dialog header="Ver" widgetVar="dialogoVer" appendTo="@(body)" modal="true"  width="90%" dynamic="true">
                <h:form class="frmAuditoria" style="margin-top: -15px; text-align: right;">
                    <p:commandButton id="auditoria" class="btnAuditoria" action="#{gestionSedeBean.getAuditoria(gestionSedeBean.objeto.auditoriaStrHTML)}" icon="ui-icon-comment" title="Auditoría" />
                </h:form>
                <p:scrollPanel mode="native" style="height:450px">
                    <h:form id="frmVer">
                        <p:panel id="pVer" header="Datos Sede" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelVer" columns="4"
                                         columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
                                         layout="grid"
                                         styleClass="ui-panelgrid-blank ui-fluid" >

                                <h:outputText value="Empresa"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.gnEmpresaId.razonSocial}"/>

                                <h:outputText value="Ubicación"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.gnUbicacionId.nombre}"/>

                                <h:outputText value="Nombre"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.nombre}"/>

                                <h:outputText value="Descripción"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.descripcion}" />

                                <h:outputText value="Dirección"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.direccion}"/>

                                <h:outputText value="Teléfono"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.telefono}"/>

                                <h:outputText value="Activo"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.activoStr}"/>

                                <h:outputText value="Tipo"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.maeTipoValor}"/>

                            </p:panelGrid>
                        </p:panel>
                        <!-- Configuraciones -->
                        <p:panel id="pConfiguracionVer" header="Configuraciones" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelVerConfiguracion" columns="2"
                                         columnClasses="ui-grid-col-4,ui-grid-col-8,ui-grid-col-4,ui-grid-col-8"
                                         layout="grid" styleClass="ui-panelgrid-blank ui-fluid">

                                <h:outputText value="Turnero"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objetoConfiguracion.turneroStr}" />

                            </p:panelGrid>                                
                        </p:panel>
                        <!-- Taquillas -->
                        <p:panel id="pTaquillasVer" header="Taquillas" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:dataTable id="tablaTaquillasVer" var="taquillaVer" value="#{gestionSedeBean.objeto.gatSedeTaquillaList}" widgetVar="tablaTaquillasVer" resizableColumns="true" emptyMessage="No se encontraron taquillas" style="text-align: center">
                                <p:column headerText="Nombre">
                                    <h:outputText value="#{taquillaVer.nombre}" />
                                </p:column>
                                <p:column headerText="Disponible">
                                    <h:outputText value="#{taquillaVer.disponibleStr}" />
                                </p:column>
                                <p:column headerText="Activo">
                                    <h:outputText value="#{taquillaVer.activoStr}" />
                                </p:column>
                                <p:column headerText="Usuario">
                                    <h:outputText value="#{taquillaVer.usuarioId.nombre}" />
                                </p:column>
                            </p:dataTable>   
                        </p:panel>
                        <!-- Funcionarios -->
                        <p:panel id="pFuncionarioVer" header="Funcionarios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:dataTable id="tablaFuncionarioVer" var="funcionarioVer" value="#{gestionSedeBean.objeto.gatSedeFuncionarioList}" widgetVar="tablaFuncionarioVer" resizableColumns="true" emptyMessage="No se encontraron funcionarios" style="text-align: center">
                                <p:column headerText="Usuario">
                                    <h:outputText value="#{funcionarioVer.usuarioId.nombre}" />
                                </p:column>
                                <p:column headerText="Activo">
                                    <h:outputText value="#{funcionarioVer.activoStr}" />
                                </p:column>
                            </p:dataTable>   
                        </p:panel>
                        <!-- Horario -->
                        <p:panel id="pHorarioVer" header="Horarios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:dataTable id="tablaHorariosVer" var="horarioVer" value="#{gestionSedeBean.objeto.gnSedeHorarioList}" widgetVar="tablaHorariosVer" resizableColumns="true" emptyMessage="No se encontraron horarios" style="text-align: center">
                                <p:column headerText="Dias">
                                    <h:outputText value="#{horarioVer.dias}" />
                                </p:column>
                                <p:column headerText="Hora Desde">
                                    <h:outputText value="#{horarioVer.horaDesdeStr}" />
                                </p:column>
                                <p:column headerText="Hora Hasta">
                                    <h:outputText value="#{horarioVer.horaHastaStr}"/>
                                </p:column>
                                <p:column headerText="Activo">
                                    <h:outputText value="#{horarioVer.activoStr}" />
                                </p:column>
                            </p:dataTable>   
                        </p:panel>
                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesVer" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoVer').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>

            <!-- Configurar -->
            <p:dialog header="Configurar" widgetVar="dialogoConfigurar" appendTo="@(body)" modal="true"  width="90%" dynamic="true">
                <h:form class="frmAuditoria" style="margin-top: -15px; text-align: right;">
                    <p:commandButton id="auditoria" class="btnAuditoria" action="#{gestionSedeBean.getAuditoria(gestionSedeBean.objeto.auditoriaStrHTML)}" icon="ui-icon-comment" title="Auditoría" />
                </h:form>
                <p:scrollPanel mode="native" style="height:400px">
                    <h:form id="frmConfigurar">
                        <!-- Datos Basicos -->
                        <p:panel id="pConfigurar" header="Datos Sede" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelConfigurar" columns="4"
                                         columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
                                         layout="grid"
                                         styleClass="ui-panelgrid-blank ui-fluid" >

                                <h:outputText value="Empresa"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.gnEmpresaId.razonSocial}"/>

                                <h:outputText value="Ubicación"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.gnUbicacionId.nombre}"/>

                                <h:outputText value="Nombre"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.nombre}"/>

                                <h:outputText value="Descripción"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.descripcion}" />

                                <h:outputText value="Dirección"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.direccion}"/>

                                <h:outputText value="Teléfono"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.telefono}"/>

                                <h:outputText value="Activo"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objeto.activoStr}"/>

                                <h:outputText value="Tipo"  class="header-back" />
                                <p:selectOneMenu id="tipoConfigurar" label="Tipo" value="#{gestionSedeBean.objeto.maeTipoId}" required="true" requiredMessage="El tipo : Este campo es obligatorio">
                                    <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />    
                                    <f:selectItems value="#{gestionSedeBean.listaTiposSede}" var="tipo" itemValue="#{tipo.id}" itemLabel="#{tipo.nombre}" itemDescription="#{tipo.descripcion}"/>
                                </p:selectOneMenu>

                            </p:panelGrid>
                        </p:panel>
                        <!-- Configuraciones -->
                        <p:panel id="pConfiguracionConfigurar" header="Configuraciones" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelConfiguracionConfigurar" columns="2"
                                         columnClasses="ui-grid-col-4,ui-grid-col-8,ui-grid-col-4,ui-grid-col-8"
                                         layout="grid" styleClass="ui-panelgrid-blank ui-fluid">

                                <h:outputText value="Turnero"  class="header-back" />

                                <p:selectOneMenu id="turneroConfigurar" value="#{gestionSedeBean.objetoConfiguracion.turnero}" required="true" requiredMessage="El tipo : Este campo es obligatorio" var="tur">
                                    <f:selectItem itemLabel="---" itemValue="0"/>
                                    <f:selectItem itemLabel="Turnero" itemValue="1"/>
                                    <f:selectItem itemLabel="Turnero Parcial" itemValue= "2"/>
                                </p:selectOneMenu>
                            </p:panelGrid> 
                        </p:panel>
                        <!-- Funcionarios -->
                        <p:panel id="pFuncionarioConfigurar" header="Funcionarios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <div align="right"> 
                                <p:commandButton immediate="true" action="#{gestionSedeBean.crearFuncionarioSede()}" icon="ui-icon-person" title="Agregar Funcionario"/>
                            </div>
                            <p:dataTable id="tablaFuncionarioConfigurar" var="funcionarioConfigurar" value="#{gestionSedeBean.objeto.gatSedeFuncionarioList}" widgetVar="tablaFuncionarioConfigurar" resizableColumns="true" emptyMessage="No se encontraron funcionarios" style="text-align: center">
                                <p:column headerText="Acciones" style="text-align: center">
                                    <p:commandButton title="Editar" immediate="true" action="#{gestionSedeBean.editarFuncionarioSede(funcionarioConfigurar)}" icon="ui-icon-pencil"/>
                                    <p:commandButton title="Borrar" immediate="true" action="#{gestionSedeBean.borrarFuncionarioSede(funcionarioConfigurar)}" icon="ui-icon-trash">
                                        <p:confirm header="Confirmación" message="¿Está seguro que desea eliminar a #{funcionarioConfigurar.usuarioId.nombre}?" icon="ui-icon-alert" />
                                    </p:commandButton>
                                </p:column>
                                <p:column headerText="Usuario">
                                    <h:outputText value="#{funcionarioConfigurar.usuarioId.nombre}" />
                                </p:column>
                                <p:column headerText="Activo">
                                    <h:outputText value="#{funcionarioConfigurar.activoStr}" />
                                </p:column>
                            </p:dataTable>   
                        </p:panel>
                        <!-- Taquillas -->
                        <p:panel id="pTaquillasConfigurar" header="Taquillas" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <div align="right"> 
                                <p:commandButton immediate="true" action="#{gestionSedeBean.crearTaquilla()}" icon="ui-icon-suitcase" title="Agregar Taquilla"/>
                            </div>
                            <p:dataTable id="tablaTaquillasConfigurar" var="taquillaConfigurar" value="#{gestionSedeBean.objeto.gatSedeTaquillaList}" widgetVar="tablaTaquillasConfigurar" resizableColumns="true" emptyMessage="No se encontraron taquillas" style="text-align: center">
                                <p:column headerText="Acciones" style="text-align: center">
                                    <p:commandButton title="Editar" immediate="true" action="#{gestionSedeBean.editarTaquilla(taquillaConfigurar)}" icon="ui-icon-pencil"/>
                                    <p:commandButton title="Ver" immediate="true" action="#{gestionSedeBean.verTaquilla(taquillaConfigurar)}" icon="ui-icon-search"/>
                                    <p:commandButton title="Borrar" immediate="true" action="#{gestionSedeBean.borrarTaquilla(taquillaConfigurar)}" icon="ui-icon-trash">
                                        <p:confirm header="Confirmación" message="¿Está seguro que desea eliminar #{taquillaConfigurar.nombre}?" icon="ui-icon-alert" />
                                    </p:commandButton>
                                    <p:commandButton rendered="#{taquillaConfigurar.usuarioId != null and taquillaConfigurar.usuarioId.id != null}" title="Liberar" immediate="true" action="#{gestionSedeBean.liberar(taquillaConfigurar.id)}" icon="ui-icon-transfer-e-w"/>
                                </p:column>
                                <p:column headerText="Nombre">
                                    <h:outputText value="#{taquillaConfigurar.nombre}" />
                                </p:column>
                                <p:column headerText="Disponible">
                                    <h:outputText value="#{taquillaConfigurar.disponibleStr}" />
                                </p:column>
                                <p:column headerText="Activo">
                                    <h:outputText value="#{taquillaConfigurar.activoStr}" />
                                </p:column>
                                <p:column headerText="Usuario">
                                    <h:outputText value="#{taquillaConfigurar.usuarioId.nombre}" />
                                </p:column>
                            </p:dataTable>   
                        </p:panel>                        
                        <!-- Horario -->
                        <p:panel id="pHorarioConfigurar" header="Horarios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <div align="right"> 
                                <p:commandButton immediate="true" action="#{gestionSedeBean.crearHorario()}" icon="ui-icon-clock" title="Agregar Horario"/>
                            </div>
                            <p:dataTable id="tablaHorariosConfigurar" var="horarioConfigurar" value="#{gestionSedeBean.objeto.gnSedeHorarioList}" widgetVar="tablaHorariosConfigurar" resizableColumns="true" emptyMessage="No se encontraron horarios" style="text-align: center">
                                <p:column headerText="Acciones" style="text-align: center">
                                    <p:commandButton title="Editar" immediate="true" action="#{gestionSedeBean.editarHorario(horarioConfigurar)}" icon="ui-icon-pencil"/>
                                    <p:commandButton title="Borrar" immediate="true" action="#{gestionSedeBean.borrarHorario(horarioConfigurar)}" icon="ui-icon-trash">
                                        <p:confirm header="Confirmación" message="¿Está seguro que desea eliminar #{horarioConfigurar.dias}?" icon="ui-icon-alert" />
                                    </p:commandButton>
                                </p:column>
                                <p:column headerText="Dias">
                                    <h:outputText value="#{horarioConfigurar.dias}" />
                                </p:column>
                                <p:column headerText="Hora Desde">
                                    <h:outputText value="#{horarioConfigurar.horaDesdeStr}"/>
                                </p:column>
                                <p:column headerText="Hora Hasta">
                                    <h:outputText value="#{horarioConfigurar.horaHastaStr}"/>
                                </p:column>
                                <p:column headerText="activo">
                                    <h:outputText value="#{horarioConfigurar.activoStr}" />
                                </p:column>
                            </p:dataTable>   
                        </p:panel>
                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesVer" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Guardar" type="button" onclick="gestionarRemote()" validateClient="true"/>
                                        <p:remoteCommand name="gestionarRemote" action ="#{gestionSedeBean.guardarConfigurar}" update="frmConfigurar"/>
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoConfigurar').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                            <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" style="left:25%"/>
                            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" style="left:25%"/>
                        </p:confirmDialog>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>

            <!-- Funcionario Sede -->
            <p:dialog header="Funcionario" widgetVar="dialogoFuncionarioSede" appendTo="@(body)" modal="true"  width="60%" dynamic="true">
                <p:scrollPanel mode="native">
                    <h:form id="frmFuncionarioSede">
                        <p:panel id="pFuncionarioSede" header="Información de funcionario" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelFuncionarioSede" columns="2" layout="grid" styleClass="showcase-text-align-center">

                                <h:outputText value="Usuario"   class="header-back" />
                                <p:selectOneMenu id="usuario" label="Usuario" value="#{gestionSedeBean.objetoFuncionarioSede.usuarioId.id}" filter="true" required="true" requiredMessage="El usuario: Este campo es obligatorio" >
                                    <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />    
                                    <f:selectItems value="#{gestionSedeBean.listaUsuarios}" var="use" itemValue="#{use.id}" itemLabel="#{use.nombre}" itemDescription="#{use.usuario}" />
                                </p:selectOneMenu>

                                <h:outputText value="Activo"  class="header-back" />
                                <p:inputSwitch id="activo" value="#{gestionSedeBean.objetoFuncionarioSede.activo}" onLabel="Sí" offLabel="No" />

                            </p:panelGrid>
                        </p:panel>
                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesFuncionarioSede" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton rendered="#{gestionSedeBean.objetoFuncionarioSede.id == null}" value="Guardar" type="button" onclick="guardarFuncionarioSedeRemote()" validateClient="true"/>
                                        <p:remoteCommand name="guardarFuncionarioSedeRemote" action ="#{gestionSedeBean.guardarFuncionarioSede}" update="frmFuncionarioSede"/>
                                        <p:commandButton rendered="#{gestionSedeBean.objetoFuncionarioSede.id != null}" value="Modificar" type="button" onclick="modificarFuncionarioSedeRemote()" validateClient="true"/>
                                        <p:remoteCommand name="modificarFuncionarioSedeRemote" action ="#{gestionSedeBean.modificarFuncionarioSede}" update="frmFuncionarioSede"/>
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoFuncionarioSede').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>

            <!-- Taquilla -->
            <p:dialog header="Taquilla" widgetVar="dialogoTaquilla" appendTo="@(body)" modal="true"  width="90%" dynamic="true">
                <p:scrollPanel mode="native" style="height:400px">
                    <h:form id="frmTaquilla">
                        <!-- Informacion -->
                        <p:panel id="pTaquilla" header="Información de taquilla" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid id="panelTaquilla" columns="4"
                                         columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
                                         layout="grid"
                                         styleClass="ui-panelgrid-blank ui-fluid" >

                                <h:outputText value="Nombre"  class="header-back" />
                                <p:inputText id="nombre" value="#{gestionSedeBean.objetoTaquilla.nombre}" maxlength="10" required="true" requiredMessage="Nombre : Este campo es obligatorio" />

                                <h:outputText value="Activo"   class="header-back" />
                                <p:inputSwitch id="activo" value="#{gestionSedeBean.objetoTaquilla.activo}" onLabel="Sí" offLabel="No" />

                                <h:outputText value="Disponible"  class="header-back" />
                                <h:outputText value="#{gestionSedeBean.objetoTaquilla.disponibleStr}" />

                            </p:panelGrid>
                        </p:panel>
                        <!-- Servicios -->
                        <p:panel id="pServicios" header="Servicios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:panelGrid columns="2" layout="grid" 
                                         columnClasses="ui-grid-col-3, ui-grid-col-9"
                                         styleClass="ui-panelgrid-blank ui-fluid" >

                                <h:outputText value="Tipo"   class="header-back" />
                                <p:column>
                                    <p:selectOneMenu id="tipoServicio" label="Tipo" value="#{gestionSedeBean.tipo.id}" style="width: 200px !important" > 
                                        <f:selectItem itemLabel=" -- " itemValue="#{null}" noSelectionOption="true" />    
                                        <f:selectItems value="#{gestionSedeBean.listaServiciosTaquilla}" var="ser" itemValue="#{ser.id}" itemLabel="#{ser.nombre}" itemDescription="#{ser.descripcion}"/>
                                        <p:ajax event="change" update="pServicios" />
                                    </p:selectOneMenu>
                                    <p:commandButton immediate="true" action="#{gestionSedeBean.guardarServicioTaquilla()}" icon="ui-icon-plusthick" title="Agregar Servicio" style="width: 3rem;" />
                                </p:column>

                            </p:panelGrid>

                            <p:dataTable id="tablaServicios" var="servicio" value="#{gestionSedeBean.objetoTaquilla.gatTaquillaServicioList}" widgetVar="tablaServicios" resizableColumns="true" emptyMessage="No se encontraron servicios" style="text-align: center; margin-top: 0.5rem;">
                                <p:column headerText="Acciones" style="text-align: center">
                                    <p:commandButton title="Borrar" immediate="true" action="#{gestionSedeBean.borrarTaquillaServicio(servicio)}" icon="ui-icon-trash">
                                        <p:confirm header="Confirmación" message="¿Está seguro que desea eliminar el servicio #{servicio.maeTipoServicioValor}?" icon="ui-icon-alert" />
                                    </p:commandButton>
                                </p:column>
                                <p:column headerText="Tipo">
                                    <h:outputText value="#{servicio.maeTipoServicioValor}" />
                                </p:column>
                            </p:dataTable>  

                        </p:panel>
                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesTaquilla" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton rendered="#{!gestionSedeBean.objetoTaquilla.modificado}" value="Guardar" type="button" onclick="guardarTaquillaRemote()" validateClient="true"/>
                                        <p:remoteCommand name="guardarTaquillaRemote" action ="#{gestionSedeBean.guardarTaquilla}" update="frmTaquilla"/>
                                        <p:commandButton rendered="#{gestionSedeBean.objetoTaquilla.modificado}" value="Modificar" type="button" onclick="modificarTaquillaRemote()" validateClient="true"/>
                                        <p:remoteCommand name="modificarTaquillaRemote" action ="#{gestionSedeBean.modificarTaquilla}" update="frmTaquilla"/>
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoTaquilla').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                        <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                            <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" style="left:25%"/>
                            <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" style="left:25%"/>
                        </p:confirmDialog>
                    </h:form>
                </p:scrollPanel>
            </p:dialog>            

            <!-- Ver Taquilla -->
            <p:dialog header="Taquilla" widgetVar="dialogoVerTaquilla" appendTo="@(body)" modal="true"  width="90%" dynamic="true">
                <h:form id="frmVerTaquilla">
                    <!-- Informacion -->
                    <p:panel id="pVerTaquilla" header="Información de taquilla" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                        <p:panelGrid id="panelVerTaquilla" columns="4"
                                     columnClasses="ui-grid-col-2,ui-grid-col-4,ui-grid-col-2,ui-grid-col-4"
                                     layout="grid"
                                     styleClass="ui-panelgrid-blank ui-fluid" >

                            <h:outputText value="Nombre"   class="header-back" />
                            <h:outputText value="#{gestionSedeBean.objetoTaquilla.nombre}" />

                            <h:outputText value="Activo"   class="header-back" />
                            <h:outputText value="#{gestionSedeBean.objetoTaquilla.activoStr}" />

                            <h:outputText value="Disponible"   class="header-back" />
                            <h:outputText value="#{gestionSedeBean.objetoTaquilla.disponibleStr}" />

                            <h:outputText value="Usuario"   class="header-back" />
                            <h:outputText value="#{gestionSedeBean.objetoTaquilla.usuarioId.nombre}" />

                        </p:panelGrid>
                    </p:panel>
                    <!-- Servicios -->
                    <p:panel id="pVerServicios" header="Servicios" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                        <p:dataTable id="tablaVerServicios" var="servicio" value="#{gestionSedeBean.objetoTaquilla.gatTaquillaServicioList}" widgetVar="tablaVerServicios" resizableColumns="true" emptyMessage="No se encontraron servicios" style="text-align: center">
                            <p:column headerText="Tipo">
                                <h:outputText value="#{servicio.maeTipoServicioValor}" />
                            </p:column>
                        </p:dataTable>   
                    </p:panel>
                    <!--Acciones-->
                    <p:panelGrid id="panelAccionesVerTaquilla" style="width:100%;margin:10px 0px">
                        <f:facet name="footer">
                            <p:row>
                                <p:column colspan="4" style="text-align: center">
                                    <p:commandButton value="Salir" type="button" onclick="PF('dialogoVerTaquilla').hide()" immediate="true" style="margin-left: 5px;"/>
                                </p:column>
                            </p:row>
                        </f:facet>
                    </p:panelGrid>
                </h:form>
            </p:dialog>   

            <!-- Horario -->
            <p:dialog header="Horario" widgetVar="dialogoHorario" appendTo="@(body)" modal="true"  width="90%" dynamic="true">
                <h:form id="frmHorario">
                    <p:panel id="pHorario" header="Información de horario" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                        <p:panelGrid id="panelHorario" columns="4" 
                                     layout="grid" 
                                     styleClass="ui-panelgrid-blank ui-fluid" >

                            <h:outputText value="Dias"  class="header-back" />
                            <p:selectCheckboxMenu id="dias" value="#{gestionSedeBean.horarioSeleccionado}" required="true" requiredMessage="Dias: Este campo es obligatorio" 
                                                  filter="true" filterMatchMode="contains">

                                <f:selectItem itemValue="L" itemLabel="Lunes" />
                                <f:selectItem itemValue="M" itemLabel="Martes" />
                                <f:selectItem itemValue="W" itemLabel="Miercoles" />
                                <f:selectItem itemValue="J" itemLabel="Jueves" />
                                <f:selectItem itemValue="V" itemLabel="Viernes" />
                                <f:selectItem itemValue="S" itemLabel="Sabados" />
                                <f:selectItem itemValue="D" itemLabel="Domingo" />
                            </p:selectCheckboxMenu>

                            <h:outputText value="Activo"  class="header-back" />
                            <p:inputSwitch id="activo" value="#{gestionSedeBean.objetoHorario.activo}" onLabel="Sí" offLabel="No" />

                            <h:outputText value="Hora Desde"  class="header-back" />
                            <p:datePicker id="horaDesde" value="#{gestionSedeBean.objetoHorario.horaDesde}" timeOnly="true" pattern="HH:mm" >
                            </p:datePicker>

                            <h:outputText value="Hora Hasta"   class="header-back" />
                            <p:datePicker id="horaHasta" value="#{gestionSedeBean.objetoHorario.horaHasta}" timeOnly="true" pattern="HH:mm" />

                        </p:panelGrid>
                    </p:panel>
                    <!--Acciones-->
                    <p:panelGrid id="panelAccionesHorario" style="width:100%;margin:10px 0px">
                        <f:facet name="footer">
                            <p:row>
                                <p:column colspan="4" style="text-align: center">
                                    <p:commandButton rendered="#{gestionSedeBean.objetoHorario.id == null and  !gestionSedeBean.objetoHorario.modificado}" value="Guardar" type="button" onclick="guardarHorarioSedeRemote()" validateClient="true"/>
                                    <p:remoteCommand name="guardarHorarioSedeRemote" action ="#{gestionSedeBean.guardarHorario}" update="frmHorario"/>
                                    <p:commandButton rendered="#{gestionSedeBean.objetoHorario.modificado}" value="Modificar" type="button" onclick="modificarHorarioSedeRemote()" validateClient="true"/>
                                    <p:remoteCommand name="modificarHorarioSedeRemote" action ="#{gestionSedeBean.modificarHorario}" update="frmHorario"/>
                                    <p:commandButton value="Salir" type="button" onclick="PF('dialogoHorario').hide()" immediate="true" style="margin-left: 5px;"/>
                                </p:column>
                            </p:row>
                        </f:facet>
                    </p:panelGrid>
                </h:form>
            </p:dialog>

            <!-- Liberar -->
            <p:dialog header="Liberar" widgetVar="dialogoLiberar" appendTo="@(body)" modal="true"  width="90%" dynamic="true">
                <h:form id="frmLiberar">
                    <p:panel id="pLiberar" header="Lista taquillas" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                        <p:dataTable id="tablaTaquillasLiberar" var="taquillaLiberar" value="#{gestionSedeBean.objeto.gatSedeTaquillaList}" widgetVar="taquillaLiberar" resizableColumns="true" emptyMessage="No se encontraron taquillas" style="text-align: center">
                            <p:column headerText="Acciones" style="text-align: center">
                                <p:commandButton rendered="#{taquillaLiberar.usuarioId != null}" title="Liberar" immediate="true" action="#{gestionSedeBean.liberar(taquillaLiberar.id)}" icon="ui-icon-transfer-e-w"/>
                            </p:column>
                            <p:column headerText="Nombre">
                                <h:outputText value="#{taquillaLiberar.nombre}" />
                            </p:column>
                            <p:column headerText="Usuario">
                                <h:outputText value="#{taquillaLiberar.usuarioId.nombre}" />
                            </p:column>
                        </p:dataTable>
                    </p:panel>
                    <!--Acciones-->
                    <p:panelGrid id="panelAccionesHorario" style="width:100%;margin:10px 0px">
                        <f:facet name="footer">
                            <p:row>
                                <p:column colspan="4" style="text-align: center">
                                    <p:commandButton value="Salir" type="button" onclick="PF('dialogoLiberar').hide()" immediate="true" style="margin-left: 5px;"/>
                                </p:column>
                            </p:row>
                        </f:facet>
                    </p:panelGrid>
                </h:form>
            </p:dialog>

            <!-- Reporte Sede -->
            <p:dialog header="Estado Actual Sede" widgetVar="dialogoReporteSede" appendTo="@(body)" modal="true"  width="90%" dynamic="true">
                <p:scrollPanel mode="native" style="height:600px">
                    <h:form id="frmReporteSede">
                        <p:toolbar>
                            <f:facet name="right">
                                <p:commandButton title="Refrescar" ajax="false" actionListener="#{gestionSedeBean.refrescarReporteSede()}" icon="ui-icon-refresh"/>
                            </f:facet>
                        </p:toolbar>
                        <p:splitter layout="vertical">
                            <p:splitterPanel>
                                <p:panel header="Información Sede y Taquillas" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                                    <p:splitter>
                                        <p:splitterPanel>

                                            <p:panelGrid>
                                                <p:row>
                                                    <p:column class="ui-g-6" style="width: 100%;background-color: #f5f5f5">
                                                        <p:outputLabel value="Información Sala" style="font-weight:bold"/>
                                                    </p:column>                                                
                                                </p:row>
                                                <p:row>
                                                    <p:column class="ui-g-2" style="width: 25%">
                                                        <p:outputLabel value="Cantidad Ticket Creados" style="font-weight:bold"/>
                                                    </p:column>
                                                    <p:column class="ui-g-4">
                                                        <p:outputLabel value="#{gestionSedeBean.objetoReporteSede.tiquetesGenerados}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column class="ui-g-2" style="width: 25%">
                                                        <p:outputLabel value="Prioritarios" style="font-weight:bold"/>
                                                    </p:column>
                                                    <p:column class="ui-g-4">
                                                        <p:outputLabel value="#{gestionSedeBean.objetoReporteSede.tiquetesPrioritarios}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column class="ui-g-2" style="width: 25%">
                                                        <p:outputLabel value="Usuarios en Atención" style="font-weight:bold"/>
                                                    </p:column>
                                                    <p:column class="ui-g-4">
                                                        <p:outputLabel value="#{gestionSedeBean.objetoReporteSede.usuarioAtencion}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column class="ui-g-2" style="width: 25%">
                                                        <p:outputLabel value="Usuarios en Espera" style="font-weight:bold"/>
                                                    </p:column>
                                                    <p:column class="ui-g-4">
                                                        <p:outputLabel value="#{gestionSedeBean.objetoReporteSede.usuarioEspera}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column class="ui-g-2" style="width: 25%">
                                                        <p:outputLabel value="Taquillas en Atención" style="font-weight:bold"/>
                                                    </p:column>
                                                    <p:column class="ui-g-4">
                                                        <p:outputLabel value="#{gestionSedeBean.objetoReporteSede.taquillasAtencion}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column class="ui-g-2" style="width: 25%">
                                                        <p:outputLabel value="Taquillas en Reposos" style="font-weight:bold"/>
                                                    </p:column>
                                                    <p:column class="ui-g-4">
                                                        <p:outputLabel value="#{gestionSedeBean.objetoReporteSede.taquillasReposo}" />
                                                    </p:column>
                                                </p:row>
                                                <p:row>
                                                    <p:column class="ui-g-2" style="width: 25%">
                                                        <p:outputLabel value="Tiempo Promedio" style="font-weight:bold"/>
                                                    </p:column>
                                                    <p:column class="ui-g-4">
                                                        <p:outputLabel value="#{gestionSedeBean.objetoReporteSede.promedioAtencion}" />
                                                    </p:column>
                                                </p:row>
                                            </p:panelGrid>
                                        </p:splitterPanel>
                                        <p:splitterPanel styleClass="flex">
                                            <p:dataTable var="taquilla" value="#{gestionSedeBean.listaReportesTaquilla}" >
                                                <p:column headerText="Taquilla">
                                                    <h:outputText value="#{taquilla.nombreTaquilla}" />
                                                </p:column>
                                                <p:column headerText="Usuarios Atención">
                                                    <h:outputText value="#{taquilla.usuariosAtencion}" />
                                                </p:column>
                                                <p:column headerText="Atendidos">
                                                    <h:outputText value="#{taquilla.atendidos}" />
                                                </p:column>
                                                <p:column headerText="Abandonos">
                                                    <h:outputText value="#{taquilla.abandonos}" />
                                                </p:column>
                                            </p:dataTable>
                                        </p:splitterPanel>
                                    </p:splitter>
                                </p:panel>
                            </p:splitterPanel>
                            <p:splitterPanel styleClass="flex align-items-center justify-content-center">
                                <p:panel header="Graficas" style="margin-bottom:10px; width: 99%" collapsed="false" toggleable="true" >
                                    <div class="card">
                                        <p:barChart model="#{gestionSedeBean.graficoBarraModelo}" style="width: 100%; height: 250px" />
                                    </div>
                                </p:panel>
                            </p:splitterPanel>
                        </p:splitter>

                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesReporte" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoReporteSede').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>  
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>

            </p:dialog>

            <!-- Historico -->
            <p:dialog header="Historico Sede #{gestionSedeBean.objeto.nombre}" widgetVar="dialogoHistoricoSede" appendTo="@(body)" modal="true"  width="90%" dynamic="true">
                <p:scrollPanel mode="native" style="height:600px">
                    <h:form id="frmHistoricoSede">
                        <p:panel id="pVariables" header="Variables Informes" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:toolbar>
                                <f:facet name="right">
                                    <p:commandButton rendered="#{gestionSedeBean.generarHistorico()}" title="Refrescar" ajax="false" actionListener="#{gestionSedeBean.refrescar()}" icon="ui-icon-refresh"/>
                                </f:facet>
                            </p:toolbar>
                            <p:panelGrid id="panelConfiguracionConfigurar" columns="2"
                                         columnClasses="ui-grid-col-4,ui-grid-col-8"
                                         layout="grid" styleClass="ui-panelgrid-blank ui-fluid">

                                <h:outputText value="Fecha Hora Inicio"  class="header-back" />
                                <p:calendar id="hFechaHoraInicio" value="#{gestionSedeBean.fechaInicio}" showOn="button" locale="es" navigator="true" pattern="yyyy-MM-dd HH:mm">
                                    
                                </p:calendar>
                                <h:outputText value="Fecha Hora Fin"  class="header-back" />
                                <p:calendar id="hFechaHoraFin" value="#{gestionSedeBean.fechaFin}" showOn="button" locale="es" navigator="true" pattern="yyyy-MM-dd HH:mm">
                                    
                                </p:calendar>
                                <p:commandButton title="Ver Histórico" actionListener="#{gestionSedeBean.generarHistorico()}" icon="ui-icon-search"/>
                            </p:panelGrid>
                        </p:panel>
                        <p:panel id="pHistorico" header="Historico" style="margin-bottom:10px;" collapsed="false" toggleable="true">
                            <p:dataTable id="pTablaHistorico" var="historico" value="#{gestionSedeBean.listaHistorico}" >
                                <p:column headerText="Fecha">
                                    <h:outputText value="#{historico.fecha}" />
                                </p:column>
                                <p:column headerText="Turnos Creados">
                                    <h:outputText value="#{historico.turnosCreados}" />
                                </p:column>
                                <p:column headerText="Atendidos">
                                    <h:outputText value="#{historico.turnosAtendidos}" />
                                </p:column>
                                <p:column headerText="Abandonados">
                                    <h:outputText value="#{historico.turnosAbandonados}" />
                                </p:column>
                                <p:column headerText="SobreAtendidos">
                                    <h:outputText value="#{historico.turnosSobreAtendidos}" />
                                </p:column>
                                <p:column headerText="Promedio Atención">
                                    <h:outputText value="#{historico.promedioAtencion}" />
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                        <!--Acciones-->
                        <p:panelGrid id="panelAccionesHistorico" style="width:100%;margin:10px 0px">
                            <f:facet name="footer">
                                <p:row>
                                    <p:column colspan="4" style="text-align: center">
                                        <p:commandButton value="Salir" type="button" onclick="PF('dialogoHistoricoSede').hide()" immediate="true" style="margin-left: 5px;"/>
                                    </p:column>
                                </p:row>
                            </f:facet>
                        </p:panelGrid>
                    </h:form>
                </p:scrollPanel>

            </p:dialog>

        </center>
    </ui:define>
</ui:composition>
